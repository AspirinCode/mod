<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6. Data Formats &mdash; MØD v0.5.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'v0.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="MØD v0.5.0 documentation" href="../index.html" />
    <link rel="next" title="7. Derivation Graph Strategies" href="../dgStrat/dgStrat.html" />
    <link rel="prev" title="5. The Wrapper Script (mod)" href="../modWrapper/modWrapper.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../dgStrat/dgStrat.html" title="7. Derivation Graph Strategies"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../modWrapper/modWrapper.html" title="5. The Wrapper Script (mod)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MØD v0.5.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="data-formats">
<h1>6. Data Formats<a class="headerlink" href="#data-formats" title="Permalink to this headline">¶</a></h1>
<p>MØD utilises several data formats and encoding schemes.</p>
<div class="section" id="tikz-rule">
<span id="rule-tikz"></span><h2>6.1. Tikz (Rule)<a class="headerlink" href="#tikz-rule" title="Permalink to this headline">¶</a></h2>
<p>This format is used for visualising rules similarly to how the <a class="reference internal" href="#graph-tikz"><span class="std std-ref">Tikz (Graph)</span></a> format is used
for graphs. A rule is depicted as its span <span class="math">\((L\leftarrow K\rightarrow R)\)</span> with the vertex
positions in the plane indicating the embedding of <span class="math">\(K\)</span> in <span class="math">\(L\)</span> and <span class="math">\(R\)</span>.
Additionally, <span class="math">\(L\backslash K\)</span> and <span class="math">\(R\backslash K\)</span> are shown in different colour in
<span class="math">\(L\)</span> and <span class="math">\(R\)</span> respectively.</p>
</div>
<div class="section" id="dot-rule">
<span id="rule-dot"></span><h2>6.2. DOT (Rule)<a class="headerlink" href="#dot-rule" title="Permalink to this headline">¶</a></h2>
<p>The DOT format (from <a class="reference external" href="http://www.graphviz.org">Graphviz</a>) is used for generating vertex coordinates for the Tikz format,
when <a class="reference external" href="http://openbabel.org">Open Babel</a> can not be used.</p>
</div>
<div class="section" id="gml-rule">
<span id="rule-gml"></span><h2>6.3. GML (Rule)<a class="headerlink" href="#gml-rule" title="Permalink to this headline">¶</a></h2>
<p>A rule <span class="math">\((L\leftarrow K\rightarrow R)\)</span> in GML format is specified as three graphs;
<span class="math">\(L\backslash K\)</span>, <span class="math">\(K\)</span>, and <span class="math">\(R\backslash K\)</span>.
Each graph is specified a a list of vertices and edges. The formal grammar for the GML format is the following.</p>
<pre>
<strong id="grammar-token-ruleGML">ruleGML        </strong> ::=  'rule ['
                        [ <a class="reference internal" href="#grammar-token-ruleId"><code class="xref docutils literal"><span class="pre">ruleId</span></code></a> ]
                        [ <a class="reference internal" href="#grammar-token-leftSide"><code class="xref docutils literal"><span class="pre">leftSide</span></code></a> ]
                        [ <a class="reference internal" href="#grammar-token-context"><code class="xref docutils literal"><span class="pre">context</span></code></a> ]
                        [ <a class="reference internal" href="#grammar-token-rightSide"><code class="xref docutils literal"><span class="pre">rightSide</span></code></a> ]
                        <a class="reference internal" href="#grammar-token-matchConstraint"><code class="xref docutils literal"><span class="pre">matchConstraint</span></code></a>*
                     ']'
<strong id="grammar-token-ruleId">ruleId         </strong> ::=  'ruleID &quot;' <code class="xref docutils literal"><span class="pre">quoteEscapedString</span></code> '&quot;'
<strong id="grammar-token-leftSide">leftSide       </strong> ::=  'left ['
                        (<a class="reference internal" href="#grammar-token-node"><code class="xref docutils literal"><span class="pre">node</span></code></a> | <a class="reference internal" href="#grammar-token-edge"><code class="xref docutils literal"><span class="pre">edge</span></code></a>)*
                     ']'
<strong id="grammar-token-context">context        </strong> ::=  'context ['
                        (<a class="reference internal" href="#grammar-token-node"><code class="xref docutils literal"><span class="pre">node</span></code></a> | <a class="reference internal" href="#grammar-token-edge"><code class="xref docutils literal"><span class="pre">edge</span></code></a>)*
                     ']'
<strong id="grammar-token-rightSide">rightSide      </strong> ::=  'right ['
                        (<a class="reference internal" href="#grammar-token-node"><code class="xref docutils literal"><span class="pre">node</span></code></a> | <a class="reference internal" href="#grammar-token-edge"><code class="xref docutils literal"><span class="pre">edge</span></code></a>)*
                     ']'
<strong id="grammar-token-node">node           </strong> ::=  'node [ id' <code class="xref docutils literal"><span class="pre">unsignedInt</span></code> 'label &quot;' <code class="xref docutils literal"><span class="pre">quoteEscapedString</span></code> '&quot; ]'
<strong id="grammar-token-edge">edge           </strong> ::=  'edge [ source' <code class="xref docutils literal"><span class="pre">unsignedInt</span></code> 'target' <code class="xref docutils literal"><span class="pre">unsignedInt</span></code> 'label &quot;' <code class="xref docutils literal"><span class="pre">quoteEscapedString</span></code> '&quot; ]'
<strong id="grammar-token-matchConstraint">matchConstraint</strong> ::=  <a class="reference internal" href="#grammar-token-adjacency"><code class="xref docutils literal"><span class="pre">adjacency</span></code></a>
<strong id="grammar-token-adjacency">adjacency      </strong> ::=  'constrainAdj ['
                        'id' <code class="xref docutils literal"><span class="pre">unsignedInt</span></code>
                        'op' <a class="reference internal" href="../pymod/RC.html#grammar-token-op"><code class="xref docutils literal"><span class="pre">op</span></code></a>
                        'count' <code class="xref docutils literal"><span class="pre">unsignedInt</span></code>
                        [ 'nodeLabels [' <a class="reference internal" href="#grammar-token-labelList"><code class="xref docutils literal"><span class="pre">labelList</span></code></a> ']' ]
                        [ 'edgeLabels [' <a class="reference internal" href="#grammar-token-labelList"><code class="xref docutils literal"><span class="pre">labelList</span></code></a> ']' ]
                     ']'
<strong id="grammar-token-labelList">labelList      </strong> ::=  ('label &quot;' <code class="xref docutils literal"><span class="pre">quoteEscapedString</span></code> '&quot;')*
<strong id="grammar-token-op">op             </strong> ::=  '&lt;' | '&lt;=' | '=' | '&gt;=' | '&gt;'
</pre>
<p>A <code class="xref std std-token docutils literal"><span class="pre">quoteEscapedString</span></code> is zero or more characters in which a double quotation character must be escaped, i.e., <code class="docutils literal"><span class="pre">\&quot;</span></code>.
GML code may have line comments, starting with <code class="docutils literal"><span class="pre">#</span></code>, which are ignored during parsing.</p>
</div>
<div class="section" id="tikz-graph">
<span id="graph-tikz"></span><h2>6.4. Tikz (Graph)<a class="headerlink" href="#tikz-graph" title="Permalink to this headline">¶</a></h2>
<p>Graphs are visualised using generated <a class="reference external" href="http://www.ctan.org/pkg/pgf">Tikz</a> code.
The coordinates for the layout is either generated using <a class="reference external" href="http://openbabel.org">Open Babel</a> or <a class="reference external" href="http://www.graphviz.org">Graphviz</a>.
The visualisation style is controlled by passing instances of the classes
<a class="reference internal" href="../libmod/Graph.html#_CPPv2N3mod12GraphPrinterE" title="mod::GraphPrinter"><code class="xref cpp cpp-class docutils literal"><span class="pre">mod::GraphPrinter</span></code></a> (C++) and <a class="reference internal" href="../pymod/Graph.html#mod.GraphPrinter" title="mod.GraphPrinter"><code class="xref py py-class docutils literal"><span class="pre">mod.GraphPrinter</span></code></a> (Python)
to the printing functions.
The drawing style is inspired by <a class="reference external" href="http://www.ctan.org/pkg/chemfig">ChemFig</a> and <a class="reference external" href="http://openbabel.org">Open Babel</a>.
See also <a class="reference internal" href="../postmod/postmod.html"><span class="doc">PostMØD (mod_post)</span></a>.</p>
</div>
<div class="section" id="dot-graph">
<span id="graph-dot"></span><h2>6.5. DOT (Graph)<a class="headerlink" href="#dot-graph" title="Permalink to this headline">¶</a></h2>
<p>The DOT format (from <a class="reference external" href="http://www.graphviz.org">Graphviz</a>) is used for generating vertex coordinates for the Tikz format,
when <a class="reference external" href="http://openbabel.org">Open Babel</a> can not be used.</p>
</div>
<div class="section" id="gml-graph">
<span id="graph-gml"></span><h2>6.6. GML (Graph)<a class="headerlink" href="#gml-graph" title="Permalink to this headline">¶</a></h2>
<p>In the GML format graphs are specified as a list of vertices and edges.
The following specifies the grammar for the format.</p>
<pre>
<strong id="grammar-token-graphGML">graphGML</strong> ::=  'graph ['
                 (<a class="reference internal" href="#grammar-token-node"><code class="xref docutils literal"><span class="pre">node</span></code></a> | <a class="reference internal" href="#grammar-token-edge"><code class="xref docutils literal"><span class="pre">edge</span></code></a>)*
              ']'
<strong id="id1">node    </strong> ::=  'node [ id' <code class="xref docutils literal"><span class="pre">unsignedInt</span></code> 'label &quot;' <code class="xref docutils literal"><span class="pre">quoteEscapedString</span></code> '&quot; ]'
<strong id="id2">edge    </strong> ::=  'edge [ source' <code class="xref docutils literal"><span class="pre">unsignedInt</span></code> 'target' <code class="xref docutils literal"><span class="pre">unsignedInt</span></code> 'label &quot;' <code class="xref docutils literal"><span class="pre">quoteEscapedString</span></code> '&quot; ]'
</pre>
<p>A <code class="xref std std-token docutils literal"><span class="pre">quoteEscapedString</span></code> is zero or more characters in which a double quotation character must be escaped, i.e., <code class="docutils literal"><span class="pre">\&quot;</span></code>.
GML code may have line comments, starting with <code class="docutils literal"><span class="pre">#</span></code>, which are ignored during parsing.</p>
</div>
<div class="section" id="smiles">
<span id="graph-smiles"></span><h2>6.7. SMILES<a class="headerlink" href="#smiles" title="Permalink to this headline">¶</a></h2>
<p>The <cite>Simplified molecular-input line-entry system</cite> is a line notation for molecules.
MØD can load most SMILES strings, and converts them internally to labelled graphs.
The SMILES strings of graphs which represents molecules can be printed.
The printed strings are canonical in the sense that the same version of MØD will print
the same SMILES string for isomorphic molecules.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The SMILES canonicalisation algorithm is the original CANGEN algorithm that does not work in general,
and some molecules with specific symmetries thus have multiple &#8220;canonical&#8221; forms.
This problem will be fixed at some point.</p>
</div>
<p>The reading of SMILES strings is based on the <a class="reference external" href="http://www.opensmiles.org/">OpenSMILES</a>
specification, but with the following notes/changes.</p>
<ul class="simple">
<li>Only single SMILES strings are accepted, i.e., not multiple strings separated by white-space.</li>
<li>The specical dot &#8220;bond&#8221; (<code class="docutils literal"><span class="pre">.</span></code>) is not allowed.</li>
<li>Isotope information is ignored.</li>
<li>Chirality information is ignored.</li>
<li>Up and down bonds are regarded as implicit bonds, i.e., they might represent either a sngle bond
or an aromatic bond. The stereo information is ignored.</li>
<li>Atom classes are ignored.</li>
<li>Wildcard atoms (specified with <code class="docutils literal"><span class="pre">*</span></code>) are converted to vertices with label <code class="docutils literal"><span class="pre">*</span></code>.
Any other information on the vertex is ignored (e.g., the charge in <code class="docutils literal"><span class="pre">[*-]</span></code>).</li>
<li>Only charges from <span class="math">\(-9\)</span> to <span class="math">\(9\)</span> are allowed.</li>
<li>The bond type <code class="docutils literal"><span class="pre">$</span></code> is currently not allowed.</li>
<li>Aromaticity can only be specified using the bond type <code class="docutils literal"><span class="pre">:</span></code>
or using the special lower case atoms.
I.e., <code class="docutils literal"><span class="pre">c1ccccc1</span></code> and <code class="docutils literal"><span class="pre">C1:C:C:C:C:C:1</span></code> represent the same molecule,
but <code class="docutils literal"><span class="pre">C1=CC=CC=C1</span></code> is a different molecule.</li>
<li>The final graph will conform to the molecule encoding scheme described below.</li>
<li>Implicit hydrogens are added following a more complicated procedure.</li>
</ul>
<p>The written SMILES strings are intended to be canonical and may not conform to any &#8220;prettyness&#8221; standards.</p>
<div class="section" id="implicit-hydrogen-atoms">
<h3>6.7.1. Implicit Hydrogen Atoms<a class="headerlink" href="#implicit-hydrogen-atoms" title="Permalink to this headline">¶</a></h3>
<p>When SMILES strings are written they will use implicit hydrogens whenever they can be inferred when reading the string.
For the purposes of implicit hydrogens we use the following definition of valence for an atom.
The valence of an atom is the weighted sum of its incident edges, where single (<code class="docutils literal"><span class="pre">-</span></code>) and aromatic (<code class="docutils literal"><span class="pre">:</span></code>) bonds have weight 1, double bounds (<code class="docutils literal"><span class="pre">=</span></code>) have weight 2,
and triple bonds (<code class="docutils literal"><span class="pre">#</span></code>) have weight 3.
If an atom has an incident aromatic bond, its valence is increased by 1.
The atoms that can have implicit hydrogens are B, C, N, O, P, S, F, Cl, Br, and I.
Each have a set of so-called <cite>normal</cite> valences as shown in the following table.
The atoms N and S additionally have certain sets of incident edges that are also considered <cite>normal</cite>, which are also listed in the table.</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Atom</th>
<th class="head">Normal Valences and Neighbourhoods</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>B</td>
<td>3</td>
</tr>
<tr class="row-odd"><td>C</td>
<td>4</td>
</tr>
<tr class="row-even"><td>N</td>
<td>3, 5, <span class="math">\(\{-, :, :\}\)</span>, <span class="math">\(\{-, -, =\}\)</span>, <span class="math">\(\{:, :, :\}\)</span></td>
</tr>
<tr class="row-odd"><td>O</td>
<td>2</td>
</tr>
<tr class="row-even"><td>P</td>
<td>3, 5</td>
</tr>
<tr class="row-odd"><td>S</td>
<td>2, 4, 6, <span class="math">\(\{:, :\}\)</span></td>
</tr>
<tr class="row-even"><td>F, Cl, Br, I</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>If the set of incident edges is listed in the table, then no hydrogens are added.
If the valence is higher than the highest normal valence, then no hydrogens are added.
Otherwise, hydrogens are added until the valence is at the next higher normal valence.</p>
<p>When writing SMILES strings the inverse procedure is used.</p>
</div>
</div>
<div class="section" id="graphdfs">
<span id="graph-graphdfs"></span><h2>6.8. GraphDFS<a class="headerlink" href="#graphdfs" title="Permalink to this headline">¶</a></h2>
<p>The GraphDFS format is intended to provide a convenient line notation for general undirected
labelled graphs. Thus it is in many aspects similar to SMILES strings, but a string being both
a valid SMILES string and GraphDFS string <strong>may not represent the same graph</strong>.
The semantics of ring-closures/back-edges are in particular not the same.</p>
<div class="section" id="grammar">
<h3>6.8.1. Grammar<a class="headerlink" href="#grammar" title="Permalink to this headline">¶</a></h3>
<pre>
<strong id="grammar-token-graphDFS">graphDFS                    </strong> ::=  <a class="reference internal" href="#grammar-token-chain"><code class="xref docutils literal"><span class="pre">chain</span></code></a>
<strong id="grammar-token-chain">chain                       </strong> ::=  <a class="reference internal" href="#grammar-token-vertex"><code class="xref docutils literal"><span class="pre">vertex</span></code></a> <a class="reference internal" href="#grammar-token-evPair"><code class="xref docutils literal"><span class="pre">evPair</span></code></a>*
<strong id="grammar-token-vertex">vertex                      </strong> ::=  (<a class="reference internal" href="#grammar-token-labelVertex"><code class="xref docutils literal"><span class="pre">labelVertex</span></code></a> | <a class="reference internal" href="#grammar-token-ringClosure"><code class="xref docutils literal"><span class="pre">ringClosure</span></code></a>) <a class="reference internal" href="#grammar-token-branch"><code class="xref docutils literal"><span class="pre">branch</span></code></a>*
<strong id="grammar-token-evPair">evPair                      </strong> ::=  <a class="reference internal" href="#grammar-token-edge"><code class="xref docutils literal"><span class="pre">edge</span></code></a> <a class="reference internal" href="#grammar-token-vertex"><code class="xref docutils literal"><span class="pre">vertex</span></code></a>
<strong id="grammar-token-labelVertex">labelVertex                 </strong> ::=  '[' <code class="xref docutils literal"><span class="pre">bracketEscapedString</span></code> ']' [ <a class="reference internal" href="#grammar-token-defRingId"><code class="xref docutils literal"><span class="pre">defRingId</span></code></a> ]
                                  <a class="reference internal" href="#grammar-token-implicitHydrogenVertexLabels"><code class="xref docutils literal"><span class="pre">implicitHydrogenVertexLabels</span></code></a> [ <a class="reference internal" href="#grammar-token-defRingId"><code class="xref docutils literal"><span class="pre">defRingId</span></code></a> ]
<strong id="grammar-token-implicitHydrogenVertexLabels">implicitHydrogenVertexLabels</strong> ::=  'B' | 'C' | 'N' | 'O' | 'P' | 'S' | 'F' | 'Cl' | 'Br' | 'I'
<strong id="grammar-token-defRingId">defRingId                   </strong> ::=  <code class="xref docutils literal"><span class="pre">unsignedInt</span></code>
<strong id="grammar-token-ringClosure">ringClosure                 </strong> ::=  <code class="xref docutils literal"><span class="pre">unsignedInt</span></code>
<strong id="id3">edge                        </strong> ::=  '{' <code class="xref docutils literal"><span class="pre">braceEscapedString</span></code> '}'
                                  <a class="reference internal" href="#grammar-token-shorthandEdgeLabels"><code class="xref docutils literal"><span class="pre">shorthandEdgeLabels</span></code></a>
<strong id="grammar-token-shorthandEdgeLabels">shorthandEdgeLabels         </strong> ::=  '-' | ':' | '=' | '#' | ''
<strong id="grammar-token-branch">branch                      </strong> ::=  '(' <a class="reference internal" href="#grammar-token-evPair"><code class="xref docutils literal"><span class="pre">evPair</span></code></a>+ ')'
</pre>
<p>A <code class="xref std std-token docutils literal"><span class="pre">bracketEscapedString</span></code> and <code class="xref std std-token docutils literal"><span class="pre">braceEscapedString</span></code> are zero or more characters
except respectively <code class="docutils literal"><span class="pre">]</span></code> and <code class="docutils literal"><span class="pre">}</span></code>. To have these characters in each of their strings
they must be escaped, i.e., <code class="docutils literal"><span class="pre">\]</span></code> and <code class="docutils literal"><span class="pre">\}</span></code> respectively.</p>
<p>The parser additionally enforces that a <a class="reference internal" href="#grammar-token-defRingId"><code class="xref std std-token docutils literal"><span class="pre">defRingId</span></code></a> may not be a number which has
previously been used.
Similarly, a <a class="reference internal" href="#grammar-token-ringClosure"><code class="xref std std-token docutils literal"><span class="pre">ringClosure</span></code></a> may only be a number which has previously occured in a
<a class="reference internal" href="#grammar-token-defRingId"><code class="xref std std-token docutils literal"><span class="pre">defRingId</span></code></a>.</p>
<p>A vertex specified via the <a class="reference internal" href="#grammar-token-implicitHydrogenVertexLabels"><code class="xref std std-token docutils literal"><span class="pre">implicitHydrogenVertexLabels</span></code></a> rule will potentially have
ekstra neighbours added after parsning. The rules are the exact same as for implicit hydrogen
atoms in <a class="reference internal" href="#graph-smiles"><span class="std std-ref">SMILES</span></a>.</p>
</div>
<div class="section" id="semantics">
<h3>6.8.2. Semantics<a class="headerlink" href="#semantics" title="Permalink to this headline">¶</a></h3>
<p>A GraphDFS string is, like the SMILES strings, an encoding of a depth-first traversal of the
graph it encodes.
Vertex labels are enclosed in square brackets and edge labels are enclosed in curly brackets.
However, a special set of labels can be specified without the enclosing brackets.
An edge label may additionally be completely omitted as a shorthand for a dash (<code class="docutils literal"><span class="pre">-</span></code>).</p>
<p>A vertex can have a numeric identifier, defined by the <a class="reference internal" href="#grammar-token-defRingId"><code class="xref std std-token docutils literal"><span class="pre">defRingId</span></code></a> non-terminal.
At a later stage this identifier can be used as a vertex specification to specify a back-edge
in the depth-first traversal.
Example: <code class="docutils literal"><span class="pre">[v1]1-[v2]-[v3]-[v4]-1</span></code>, specifies a labelled <span class="math">\(C_3\)</span>
(which equivalently can be specified shorter as <code class="docutils literal"><span class="pre">[v1]1[v2][v3][v4]1</span></code>).</p>
<p>A <a class="reference internal" href="#grammar-token-vertex"><code class="xref std std-token docutils literal"><span class="pre">vertex</span></code></a> being a <a class="reference internal" href="#grammar-token-ringClosure"><code class="xref std std-token docutils literal"><span class="pre">ringClosure</span></code></a> can never be the first vertex in a string, and
is thus preceded with a <a class="reference internal" href="#grammar-token-edge"><code class="xref std std-token docutils literal"><span class="pre">edge</span></code></a>. As in a depth-first traversal, such a back-edge is a
kind of degenerated branch. Example: <code class="docutils literal"><span class="pre">[v1]1[v2][v3][v4]1[v5][v6]1</span></code>, this specifies a graph
which is two fused <span class="math">\(C_4\)</span> with a common edge (and not just a common vertex).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The semantics of back-edges/ring closures are <strong>not</strong> the same as in SMILES strings.
In SMILES, a pair of matching numeric identifiers denote the individual back-edges.</p>
</div>
<p>A branch in the depth-first traversal is enclosed in parentheses.</p>
</div>
<div class="section" id="abstracted-molecules">
<h3>6.8.3. Abstracted Molecules<a class="headerlink" href="#abstracted-molecules" title="Permalink to this headline">¶</a></h3>
<p>The short-hand labels for vertices and edges makes it easier to specify partial molecules
than using <a class="reference internal" href="#graph-gml"><span class="std std-ref">GML</span></a> files.</p>
<p>As example, consider modelling Acetyl-CoA in which we wish to abstract most of the CoA part.
The GraphDFS string <code class="docutils literal"><span class="pre">CC(=O)S[CoA]</span></code> can be used and we let the library add missing hydrogen
atoms to the vertices which encode atoms. A plain CoA molecule would in this modelling be
<code class="docutils literal"><span class="pre">[CoA]S</span></code>, or a bit more verbosely as <code class="docutils literal"><span class="pre">[CoA]S[H]</span></code>.</p>
<p>The format can also be used to create completely abstract structures
(it can encode any undirected labelled graph), e.g., RNA strings.
Note that in this case it may not be appropriate to add &#8220;missing&#8221; hydrogen atoms.
This can be controlled by an optional parameter to the loading function.</p>
</div>
</div>
<div class="section" id="molecule-encoding">
<span id="mol-enc"></span><h2>6.9. Molecule Encoding<a class="headerlink" href="#molecule-encoding" title="Permalink to this headline">¶</a></h2>
<p>There is no strict requirement that graphs encode molecules, however several optimizations
are in place when they do.
The following describes how to encode molecules as undirected, simple, labelled graphs and thus
when the library assumes a graph is a molecule.</p>
<div class="section" id="edges-bonds">
<h3>6.9.1. Edges / Bonds<a class="headerlink" href="#edges-bonds" title="Permalink to this headline">¶</a></h3>
<p>An edge encodes a chemical bond if and only if its label is listed in the table below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Label</th>
<th class="head">Interpretation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">-</span></code></td>
<td>Single bond</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">:</span></code></td>
<td>&#8220;Aromatic&#8221; bond</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">=</span></code></td>
<td>Double bond</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">#</span></code></td>
<td>Triple bond</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="vertices-atoms">
<h3>6.9.2. Vertices / Atoms<a class="headerlink" href="#vertices-atoms" title="Permalink to this headline">¶</a></h3>
<p>A vertex encodes an atom with a charge if and only if its label conforms to the following grammar.</p>
<pre>
<strong id="grammar-token-vertexLabel">vertexLabel</strong> ::=  <code class="xref docutils literal"><span class="pre">atomSymbol</span></code> [ charge ]
<strong id="grammar-token-charge">charge     </strong> ::=  <code class="xref docutils literal"><span class="pre">singleDigit</span></code> ('-' | '+')
</pre>
<p>With <code class="xref std std-token docutils literal"><span class="pre">atomSymbol</span></code> being a properly capitalised atom symbol.</p>
<p>Currently there are no valence requirements for a graph being recognised as a molecule.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">6. Data Formats</a><ul>
<li><a class="reference internal" href="#tikz-rule">6.1. Tikz (Rule)</a></li>
<li><a class="reference internal" href="#dot-rule">6.2. DOT (Rule)</a></li>
<li><a class="reference internal" href="#gml-rule">6.3. GML (Rule)</a></li>
<li><a class="reference internal" href="#tikz-graph">6.4. Tikz (Graph)</a></li>
<li><a class="reference internal" href="#dot-graph">6.5. DOT (Graph)</a></li>
<li><a class="reference internal" href="#gml-graph">6.6. GML (Graph)</a></li>
<li><a class="reference internal" href="#smiles">6.7. SMILES</a><ul>
<li><a class="reference internal" href="#implicit-hydrogen-atoms">6.7.1. Implicit Hydrogen Atoms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#graphdfs">6.8. GraphDFS</a><ul>
<li><a class="reference internal" href="#grammar">6.8.1. Grammar</a></li>
<li><a class="reference internal" href="#semantics">6.8.2. Semantics</a></li>
<li><a class="reference internal" href="#abstracted-molecules">6.8.3. Abstracted Molecules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#molecule-encoding">6.9. Molecule Encoding</a><ul>
<li><a class="reference internal" href="#edges-bonds">6.9.1. Edges / Bonds</a></li>
<li><a class="reference internal" href="#vertices-atoms">6.9.2. Vertices / Atoms</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../modWrapper/modWrapper.html"
                        title="previous chapter">5. The Wrapper Script (<code class="docutils literal"><span class="pre">mod</span></code>)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../dgStrat/dgStrat.html"
                        title="next chapter">7. Derivation Graph Strategies</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/dataDesc/dataDesc.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../dgStrat/dgStrat.html" title="7. Derivation Graph Strategies"
             >next</a> |</li>
        <li class="right" >
          <a href="../modWrapper/modWrapper.html" title="5. The Wrapper Script (mod)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MØD v0.5.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013-2015, Jakob Lykke Andersen.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4a0+.
    </div>
  </body>
</html>